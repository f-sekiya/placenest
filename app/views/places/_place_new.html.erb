<details class="place-add" <%= "open" if open %>>
  <summary class="place-add__summary btn btn--primary" title="Placeを追加">＋</summary>

  <div class="place-add__body">
    <%= form_with model: place, url: places_path, class: "place-add__form" do |f| %>
      <%= f.hidden_field :parent_id, value: parent_id %>
      <%= hidden_field_tag :return_place_id, parent_id %>

      <div class="place-add__row">
        <%= f.text_field :name, placeholder: "Place名（必須）", required: true, class: "input" %>
        
        <%= f.text_area :description, placeholder: "メモ（任意）", rows: 2, class: "input" %>

        <!-- 子として作成（従来どおり） -->
        <%= button_tag "子に追加",
                      type: "submit",
                      name: "place_scope",
                      value: "child",
                      class: "btn btn--primary" %>

        <!-- ルートとして作成（parent_id を無視させる） -->
        <%= button_tag "ルートに追加",
                      type: "submit",
                      name: "place_scope",
                      value: "root",
                      class: "btn btn--ghost" %>
      </div>

      <% if place.errors.any? %>
        <p class="place-add__error"><%= place.errors.full_messages.to_sentence %></p>
      <% end %>
    <% end %>

    <p class="place-add__hint">もう一度「＋」を押すと閉じられます。</p>
  </div>
</details>
